<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ù†Ø¸ÙˆÙ…Ø© ØªÙƒÙˆÙŠØ¯ Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª Ø§Ù„Ù…ØªØ·ÙˆØ±Ø© - ÙƒÙØ± ØµÙ‚Ø±</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
:root { 
--primary: #1a5276; --secondary: #27ae60; --accent: #d35400; --danger: #e74c3c;
--warning: #f39c12; --info: #3498db; --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
--glass-white: rgba(255, 255, 255, 0.85); --glass-border: rgba(255, 255, 255, 0.5);
--text-dark: #2c3e50; --shadow-lg: 0 20px 60px rgba(0,0,0,0.3);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { 
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
background: var(--bg-gradient); background-attachment: fixed;
direction: rtl; color: var(--text-dark); padding-bottom: 100px; min-height: 100vh;
}
header { 
background: rgba(26, 82, 118, 0.95); backdrop-filter: blur(20px);
-webkit-backdrop-filter: blur(20px); color: white; padding: 20px 5%; 
display: flex; justify-content: space-between; align-items: center; 
box-shadow: var(--shadow-lg); border-bottom: 3px solid rgba(255, 255, 255, 0.3);
position: sticky; top: 0; z-index: 1000; animation: slideDown 0.5s ease;
}
@keyframes slideDown { from { transform: translateY(-100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
@keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
@keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
.header-title h1 { margin: 0; font-size: 1.4rem; text-shadow: 0 3px 6px rgba(0,0,0,0.3); }
.header-title small { color: #f1c40f; font-size: 0.85rem; display: block; margin-top: 5px; }
.container { max-width: 1400px; margin: 30px auto; padding: 0 20px; }
.card { 
background: var(--glass-white); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
padding: 40px; border-radius: 30px; border: 2px solid var(--glass-border);
box-shadow: var(--shadow-lg); animation: fadeIn 0.6s ease; margin-bottom: 30px;
}
.portal-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 35px; margin-top: 50px; }
.portal-box {
background: var(--glass-white); backdrop-filter: blur(20px); padding: 60px 35px;
border-radius: 35px; text-align: center; cursor: pointer; border: 3px solid transparent;
transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
box-shadow: 0 15px 40px rgba(0,0,0,0.15); position: relative; overflow: hidden;
}
.portal-box::before {
content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
transform: scale(0); transition: transform 0.6s ease;
}
.portal-box:hover::before { transform: scale(1); }
.portal-box:hover { transform: translateY(-10px) scale(1.03); border-color: var(--primary);
background: white; box-shadow: 0 25px 60px rgba(26, 82, 118, 0.3); }
.portal-box i { font-size: 90px; display: block; margin-bottom: 25px; animation: pulse 2s infinite; }
.portal-box h2 { color: var(--primary); margin: 15px 0; font-size: 1.5rem; }
.portal-box p { color: #666; font-size: 1rem; line-height: 1.6; }
.search-results { 
max-height: 250px; overflow-y: auto; background: white; border: 2px solid var(--glass-border); 
border-radius: 15px; display: none; position: absolute; width: 100%; z-index: 999;
box-shadow: 0 10px 30px rgba(0,0,0,0.2); margin-top: 5px;
}
.result-item { padding: 15px; cursor: pointer; border-bottom: 1px solid #eee; 
transition: all 0.3s; color: #333; font-weight: 500; }
.result-item:hover { background: linear-gradient(90deg, var(--primary) 0%, var(--info) 100%); 
color: white; padding-right: 25px; }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
gap: 25px; margin-bottom: 35px; }
.stat-card { 
background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.6) 100%); 
backdrop-filter: blur(10px); padding: 30px; border-radius: 25px; text-align: center; 
border: 2px solid var(--glass-border); box-shadow: 0 8px 25px rgba(0,0,0,0.1);
transition: all 0.4s ease; position: relative; overflow: hidden;
}
.stat-card::before {
content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 5px;
background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
}
.stat-card:hover { transform: translateY(-10px) rotate(2deg); box-shadow: 0 15px 40px rgba(0,0,0,0.2); }
.stat-card h3 { margin: 15px 0; font-size: 2.5rem; background: linear-gradient(45deg, var(--primary), var(--info));
-webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; }
.stat-card p { margin: 0; color: #555; font-size: 1rem; font-weight: 600; text-transform: uppercase; }
.form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; }
.input-group { display: flex; flex-direction: column; margin-bottom: 20px; position: relative; }
.input-group label { margin-bottom: 12px; font-weight: 700; color: var(--primary); font-size: 1rem;
display: flex; align-items: center; gap: 8px; }
.input-group label::before { content: 'â—'; color: var(--accent); font-size: 0.8rem; }
.input-group input, .input-group select, .input-group textarea { 
padding: 16px; border: 2px solid var(--glass-border); border-radius: 15px; 
background: rgba(255, 255, 255, 0.95); font-size: 1.05rem; transition: all 0.3s;
font-family: inherit; font-weight: 500;
}
.input-group input:focus, .input-group select:focus, .input-group textarea:focus { 
outline: none; border-color: var(--primary); 
box-shadow: 0 0 0 5px rgba(26, 82, 118, 0.15); transform: translateY(-2px); 
}
.input-group input.error { border-color: var(--danger); animation: shake 0.5s; }
@keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 
75% { transform: translateX(10px); } }
.validation-msg { font-size: 0.85rem; margin-top: 8px; padding: 8px 12px; border-radius: 8px;
display: none; font-weight: 600; }
.validation-msg.error { background: rgba(231, 76, 60, 0.1); color: var(--danger); display: block; }
.validation-msg.success { background: rgba(39, 174, 96, 0.1); color: var(--secondary); display: block; }
table { width: 100%; border-collapse: separate; border-spacing: 0 10px; background: transparent; }
thead { position: sticky; top: 80px; z-index: 100; }
th { background: linear-gradient(135deg, rgba(26, 82, 118, 0.95) 0%, rgba(52, 152, 219, 0.95) 100%); 
color: white; padding: 20px; font-size: 1rem; font-weight: 700; text-transform: uppercase;
box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
th:first-child { border-radius: 0 20px 20px 0; }
th:last-child { border-radius: 20px 0 0 20px; }
td { padding: 18px; background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(8px); 
border-top: 2px solid var(--glass-border); border-bottom: 2px solid var(--glass-border);
font-weight: 500; transition: all 0.3s; }
tr:hover td { background: rgba(255, 255, 255, 0.98); transform: scale(1.01); }
td:first-child { border-right: 2px solid var(--glass-border); border-radius: 0 20px 20px 0; }
td:last-child { border-left: 2px solid var(--glass-border); border-radius: 20px 0 0 20px; }
.btn { 
cursor: pointer; border: none; padding: 14px 24px; border-radius: 16px; font-weight: 700; 
transition: all 0.4s ease; display: inline-flex; align-items: center; justify-content: center; 
gap: 10px; box-shadow: 0 6px 20px rgba(0,0,0,0.15); font-size: 1rem;
position: relative; overflow: hidden; text-transform: uppercase; letter-spacing: 0.5px;
}
.btn::before {
content: ''; position: absolute; top: 50%; left: 50%; width: 0; height: 0;
background: rgba(255,255,255,0.3); border-radius: 50%; transition: width 0.6s, height 0.6s;
transform: translate(-50%, -50%);
}
.btn:hover::before { width: 300px; height: 300px; }
.btn:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.25); }
.btn:active { transform: translateY(-1px); }
.btn-primary { background: linear-gradient(135deg, var(--secondary) 0%, #229954 100%); color: white; }
.btn-auto { background: linear-gradient(135deg, var(--info) 0%, #2874a6 100%); color: white; }
.btn-edit { background: linear-gradient(135deg, var(--warning) 0%, #d68910 100%); color: white; }
.btn-del { background: linear-gradient(135deg, var(--danger) 0%, #c0392b 100%); color: white; }
.btn-wa { background: linear-gradient(135deg, #25D366 0%, #128C7E 100%); color: white; }
.btn-print { background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%); color: white; }
.admin-content { display: none; padding: 30px 0; }
.modal { 
display: none; position: fixed; z-index: 10000; top: 0; left: 0; width: 100%; height: 100%; 
background: rgba(0,0,0,0.75); backdrop-filter: blur(15px); overflow-y: auto; 
animation: fadeIn 0.3s ease;
}
.modal-content { 
background: linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(255, 255, 255, 0.95) 100%); 
margin: 3% auto; padding: 45px; width: 92%; max-width: 750px; border-radius: 35px; 
border: 3px solid var(--glass-border); box-shadow: 0 30px 80px rgba(0,0,0,0.4);
position: relative; animation: slideDown 0.5s ease;
}
.modal-content h3 { color: var(--primary); border-bottom: 3px solid var(--glass-border); 
padding-bottom: 20px; margin-top: 0; font-size: 1.8rem; }
.close-modal { position: absolute; top: 20px; left: 25px; color: var(--danger); 
font-size: 45px; cursor: pointer; transition: all 0.3s; font-weight: bold; }
.close-modal:hover { transform: rotate(90deg) scale(1.2); color: #c0392b; }
.engineer-footer { 
background: linear-gradient(135deg, rgba(28, 40, 51, 0.98) 0%, rgba(44, 62, 80, 0.98) 100%); 
backdrop-filter: blur(15px); color: #ecf0f1; text-align: center; padding: 18px; 
position: fixed; bottom: 0; width: 100%; font-size: 0.95rem; 
border-top: 4px solid var(--accent); z-index: 999; box-shadow: 0 -5px 20px rgba(0,0,0,0.3);
font-weight: 600; letter-spacing: 0.5px;
}
.support-box { 
background: linear-gradient(135deg, rgba(52, 152, 219, 0.12) 0%, rgba(155, 89, 182, 0.12) 100%); 
border: 3px dashed rgba(52, 152, 219, 0.5); border-radius: 25px; padding: 30px; 
margin-top: 35px; text-align: center; box-shadow: 0 5px 20px rgba(0,0,0,0.1);
}
.support-box p { margin-top: 0; font-weight: 700; color: var(--primary); font-size: 1.2rem; 
margin-bottom: 20px; }
.loading { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
z-index: 20000; }
.spinner { border: 8px solid rgba(255,255,255,0.3); border-top: 8px solid var(--primary);
border-radius: 50%; width: 80px; height: 80px; animation: spin 1s linear infinite; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
@media print { body * { visibility: hidden; } #printSection, #printSection * { visibility: visible; }
#printSection { position: absolute; left: 0; top: 0; width: 100%; } }
@media (max-width: 768px) { .form-grid { grid-template-columns: 1fr; } 
.portal-container { grid-template-columns: 1fr; } .header-title h1 { font-size: 1.1rem; } }
</style>
</head>
<body>
<div class="loading" id="loadingSpinner"><div class="spinner"></div></div>
<header>
<div class="header-title">
<h1>ğŸ›ï¸ Ø±Ø¦Ø§Ø³Ø© Ù…Ø±ÙƒØ² ÙˆÙ…Ø¯ÙŠÙ†Ø© ÙƒÙØ± ØµÙ‚Ø±</h1>
<small>Ø¯/ Ø£Ø­Ù…Ø¯ Ø§Ù„Ù…Ù‚Ø¯Ù… - Ø±Ø¦ÙŠØ³ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</small>
</div>
<div style="display:flex; gap:12px; flex-wrap: wrap;">
<button id="goPortalBtn" class="btn" style="background: rgba(255,255,255,0.15); color: white; display:none;" onclick="location.reload()">ğŸ  Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</button>
<button id="loginBtn" class="btn" style="background: rgba(255,255,255,0.25); color: white; border: 2px solid rgba(255,255,255,0.4);">ğŸ” Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
</div>
</header>
<div class="container">
<div id="portalSection">
<h2 style="text-align: center; color: white; margin-top: 50px; margin-bottom: 15px; font-size: 2.5rem; text-shadow: 0 4px 10px rgba(0,0,0,0.3);">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ±Ø©</h2>
<p style="text-align: center; color: rgba(255,255,255,0.9); margin-bottom: 50px; font-size: 1.2rem; text-shadow: 0 2px 5px rgba(0,0,0,0.2);">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø°ÙŠ ØªØ±ØºØ¨ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„ÙŠÙ‡</p>
<div class="portal-container">
<div class="portal-box" onclick="openService('citizenPage')">
<i style="font-style: normal; font-size: 85px;">ğŸšœ</i>
<h2>Ù‚Ø³Ù… ØªÙƒÙˆÙŠØ¯ Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª</h2>
<p>ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆÙƒØªÙˆÙƒ ÙˆØ§Ù„Ù…ÙˆØªÙˆØ³ÙŠÙƒÙ„ ÙˆØ§Ù„ØªØ±ÙˆØ³ÙŠÙƒÙ„ ÙˆØ§Ù„Ù…ÙŠÙƒØ±ÙˆØ¨Ø§Øµ Ø¨Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø°ÙƒÙŠØ©</p>
</div>
<div class="portal-box" onclick="openService('complaintsModule')" style="border-bottom: 6px solid var(--accent);">
<i style="font-style: normal; font-size: 85px;">âš–ï¸</i>
<h2 style="color: var(--accent);">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ§Ù„Ø£Ù…Ù†</h2>
<p>ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª ÙˆØ§Ù„Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£Ù…Ù†ÙŠ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ø¹ Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„</p>
</div>
</div>
</div>
<div id="citizenPage" style="display:none;">
<div class="card">
<h2 style="text-align: center; color: var(--primary); margin-bottom: 40px; font-size: 2rem;">ğŸ“ ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ÙƒØ¨Ø© ÙÙŠ Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø©</h2>
<div class="form-grid">
<div class="input-group" style="grid-column: 1 / -1;">
<label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ Ù„Ù„Ù…Ø§Ù„Ùƒ</label>
<input type="text" id="ownerName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©">
</div>
<div class="input-group">
<label>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ (14 Ø±Ù‚Ù…)</label>
<input type="text" id="nationalId" maxlength="14" placeholder="Ù…Ø«Ø§Ù„: 29501011234567" oninput="validateNationalId(this)">
<div id="nidValidation" class="validation-msg"></div>
</div>
<div class="input-group">
<label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ (Ù„Ù„ØªØ­Ù‚Ù‚)</label>
<input type="date" id="birthDate" onchange="verifyBirthDate()">
<div id="birthValidation" class="validation-msg"></div>
</div>
<div class="input-group">
<label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (11 Ø±Ù‚Ù…)</label>
<input type="tel" id="phone" maxlength="11" placeholder="01XXXXXXXXX" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
</div>
<div class="input-group">
<label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</label>
<select id="vType">
<option value="ØªÙˆÙƒØªÙˆÙƒ">ØªÙˆÙƒØªÙˆÙƒ</option>
<option value="Ù…ÙˆØªÙˆØ³ÙŠÙƒÙ„">Ù…ÙˆØªÙˆØ³ÙŠÙƒÙ„</option>
<option value="ØªØ±ÙˆØ³ÙŠÙƒÙ„">ØªØ±ÙˆØ³ÙŠÙƒÙ„</option>
<option value="Ù…ÙŠÙƒØ±ÙˆØ¨Ø§Øµ">Ù…ÙŠÙƒØ±ÙˆØ¨Ø§Øµ</option>
</select>
</div>
<div class="input-group">
<label>Ù…ÙˆØ¯ÙŠÙ„ Ø§Ù„Ù…Ø±ÙƒØ¨Ø© (Ø§Ù„Ø³Ù†Ø©)</label>
<select id="vYear"><option value="">Ø§Ø®ØªØ± Ø§Ù„Ø³Ù†Ø©...</option></select>
</div>
<div class="input-group">
<label>Ù„ÙˆÙ† Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</label>
<input type="text" id="vColor" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø±ØŒ Ø£Ø³ÙˆØ¯ØŒ Ø£Ø¨ÙŠØ¶...">
</div>
<div class="input-group" style="grid-column: 1 / -1;">
<label>Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù‚Ø±ÙŠØ© / Ø§Ù„Ù…Ù†Ø·Ù‚Ø©:</label>
<input type="text" id="locSearchInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØ§Ù† Ù‡Ù†Ø§ (Ù…Ø«Ù„Ø§Ù‹: Ø§Ù„Ø¨ÙˆÙ‡Ø§ØŒ Ø­ÙŠ ØªÙŠØ³ÙŠØ±...)" onkeyup="filterLocations()">
<div id="resultsList" class="search-results"></div>
</div>
<div class="input-group" id="detailSection" style="display:none; grid-column: 1 / -1;">
<label id="selectedPlaceLabel"></label>
<textarea id="detailedAddress" rows="3" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø´Ø§Ø±Ø¹ØŒ Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù„ØŒ Ø£Ùˆ Ø¹Ù„Ø§Ù…Ø© Ù…Ù…ÙŠØ²Ø©..."></textarea>
</div>
<div class="input-group" style="grid-column: 1 / -1;">
<label>Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª (Cloudinary - 25 GB Ù…Ø¬Ø§Ù†ÙŠ)</label>
<input type="file" id="multiFiles" multiple accept="image/*" style="background: linear-gradient(135deg, rgba(26, 82, 118, 0.08) 0%, rgba(52, 152, 219, 0.08) 100%); padding: 30px; border: 3px dashed var(--primary); font-weight: 600;">
<small style="color: #666; margin-top: 10px; display: block;">âœ“ Ø±ÙØ¹ Ø¹Ù„Ù‰ Cloudinary (25 GB Ù…Ø¬Ø§Ù†ÙŠ) - Ø¶ØºØ· Ø°ÙƒÙŠ (800px) - ~35,000 Ø¹Ù…ÙŠÙ„ Ù…Ø¬Ø§Ù†Ø§Ù‹</small>
</div>
</div>
<button id="submitBtn" class="btn btn-primary" style="width: 100%; font-size: 1.4rem; margin-top: 35px; padding: 20px;">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ âœ…</button>
<div class="support-box">
<p>Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ ÙˆØ§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©:</p>
<div style="display:flex; justify-content:center; gap:15px; flex-wrap:wrap;">
<a href="https://wa.me/201021102607" target="_blank" class="btn btn-wa">ğŸ’¬ ÙˆØ§ØªØ³Ø§Ø¨</a>
<a href="tel:01021102607" class="btn btn-wa" style="background: linear-gradient(135deg, var(--info) 0%, #2874a6 100%);">ğŸ“ Ø§ØªØµØ§Ù„</a>
</div>
</div>
</div>
</div>
<div id="complaintsModule" style="display:none;">
<div class="card" style="border: 3px solid var(--accent);">
<h2 style="text-align: center; color: var(--accent); margin-bottom: 30px; font-size: 2rem;">âš ï¸ Ù‚Ø³Ù… Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£Ù…Ù†ÙŠ</h2>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;">
<div class="input-group">
<label>Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰ / Ø§Ù„Ø¨Ù„Ø§Øº</label>
<select id="compType" style="padding: 16px; border-radius: 15px; border: 2px solid var(--glass-border);">
<option value="Ø¨Ù„Ø§Øº Ø¹Ù† Ù…Ø±ÙƒØ¨Ø© Ù…Ø®Ø§Ù„ÙØ©">Ø¨Ù„Ø§Øº Ø¹Ù† Ù…Ø±ÙƒØ¨Ø© Ù…Ø®Ø§Ù„ÙØ©</option>
<option value="ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ù…Ù†ÙŠØ©">ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ù…Ù†ÙŠØ©</option>
<option value="Ø´ÙƒÙˆÙ‰ Ù…Ù† Ø³Ø§Ø¦Ù‚">Ø´ÙƒÙˆÙ‰ Ù…Ù† Ø³Ø§Ø¦Ù‚</option>
<option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
</select>
</div>
<div class="input-group">
<label>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„ØªÙˆØ§ØµÙ„ (11 Ø±Ù‚Ù…)</label>
<input type="tel" id="compPhone" maxlength="11" placeholder="010XXXXXXXX" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
</div>
<div class="input-group" style="grid-column: 1 / -1;">
<label>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© / Ø§Ù„Ø¨Ù„Ø§Øº</label>
<textarea id="compDetails" rows="4" placeholder="Ø§ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¨Ù„Ø§Øº Ù‡Ù†Ø§ Ù„ØªÙˆØ«ÙŠÙ‚Ù‡ Ø£Ù…Ù†ÙŠØ§Ù‹..." style="padding: 16px; border-radius: 15px; border: 2px solid var(--glass-border); font-family: inherit;"></textarea>
</div>
<div class="input-group">
<label>ğŸ“¸ ØµÙˆØ±Ø© Ø³ÙŠÙ„ÙÙŠ (Ù„Ù„Ù…Ø±Ø³Ù„)</label>
<input type="file" id="compSelfie" accept="image/*" style="padding: 12px;">
</div>
<div class="input-group">
<label>ğŸªª ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (Ø´Ø®ØµÙŠ)</label>
<input type="file" id="compIdCard" accept="image/*" style="padding: 12px;">
</div>
<div class="input-group">
<label>ğŸ”¢ ØµÙˆØ±Ø© Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</label>
<input type="file" id="compPlate" accept="image/*" style="padding: 12px;">
</div>
<div class="input-group">
<label>ğŸ‘¤ ØµÙˆØ±Ø© Ø§Ù„Ø³Ø§Ø¦Ù‚ Ø£Ùˆ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</label>
<input type="file" id="compDriverImg" accept="image/*" style="padding: 12px;">
</div>
</div>
<button id="submitCompBtn" class="btn" style="width: 100%; background: linear-gradient(135deg, var(--accent) 0%, #ba4a00 100%); color: white; padding: 20px; font-size: 1.3rem; margin-top: 30px;">
Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø´ÙƒÙˆÙ‰ ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£Ù…Ù†ÙŠ âœ‰ï¸
</button>
</div>
</div>
</div>
<div id="adminPage" class="admin-content">
<div class="stats-grid">
<div class="stat-card"><p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª</p><h3 id="statTotal">0</h3></div>
<div class="stat-card"><p>Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„ÙˆØ§Ø±Ø¯Ø©</p><h3 id="statCompTotal">0</h3></div>
<div class="stat-card"><p>ØªÙ… Ø§Ù„ØªÙƒÙˆÙŠØ¯</p><h3 id="statCoded">0</h3></div>
<div class="stat-card"><p>Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</p><h3 id="statPending">0</h3></div>
</div>
<div class="card">
<div style="display:flex; gap:15px; margin-bottom:35px; flex-wrap: wrap;">
<button id="showOrdersBtn" class="btn" style="background: linear-gradient(135deg, var(--primary) 0%, var(--info) 100%); color: white;">ğŸšœ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª</button>
<button id="showComplaintsBtn" class="btn" style="background: linear-gradient(135deg, var(--accent) 0%, #ba4a00 100%); color: white;">âš–ï¸ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰</button>
<input type="text" id="searchInput" style="flex:1; padding:16px; border-radius:16px; border:2px solid var(--glass-border); background:rgba(255,255,255,0.95); font-weight:600;" placeholder="ğŸ” Ø¨Ø­Ø« Ø¹Ø§Ù… ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...">
<button id="exportExcelBtn" class="btn" style="background: linear-gradient(135deg, var(--secondary) 0%, #229954 100%); color:white;">ğŸ“Š ØªØµØ¯ÙŠØ± Excel</button>
<button onclick="location.reload()" class="btn btn-del">ğŸšª Ø®Ø±ÙˆØ¬</button>
</div>
<div id="ordersTableContainer" style="overflow-x:auto;">
<table id="excelTable">
<thead>
<tr>
<th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨</th><th>Ø§Ù„Ù…Ø§Ù„Ùƒ</th><th>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ</th><th>Ø§Ù„Ù‡Ø§ØªÙ</th>
<th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„</th><th>Ø§Ù„ÙƒÙˆØ¯</th>
<th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙƒÙˆÙŠØ¯</th><th>Ø§Ù„ØµÙˆØ±</th><th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
</tr>
</thead>
<tbody id="dataTable"></tbody>
</table>
</div>
<div id="complaintsTableContainer" style="overflow-x:auto; display: none;">
<table id="complaintsTable">
<thead>
<tr>
<th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ù„Ø§Øº</th><th>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰</th>
<th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th><th>Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª (4 ØµÙˆØ±)</th><th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
</tr>
</thead>
<tbody id="compTableBody"></tbody>
</table>
</div>
</div>
</div>
<div id="imgModal" class="modal">
<span class="close-modal" id="closeModalBtn">&times;</span>
<img id="mainViewImg" style="max-width:90%; max-height:80vh; display:block; margin:80px auto 30px; border:8px solid white; border-radius:25px; box-shadow: 0 0 60px rgba(0,0,0,0.8);">
<div id="modalThumbnails" style="display: flex; justify-content: center; gap: 15px; padding: 25px; flex-wrap: wrap;"></div>
</div>
<div id="editModal" class="modal">
<div class="modal-content">
<span class="close-modal" onclick="document.getElementById('editModal').style.display='none'">&times;</span>
<h3>ğŸ”§ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</h3>
<div class="form-grid" style="grid-template-columns: 1fr 1fr; margin-top:25px;">
<div class="input-group" style="grid-column: 1 / -1;">
<label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ</label>
<input type="text" id="editOwner">
</div>
<div class="input-group">
<label>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ</label>
<input type="text" id="editNid" maxlength="14">
</div>
<div class="input-group">
<label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
<input type="tel" id="editPhone" maxlength="11">
</div>
<div class="input-group">
<label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</label>
<select id="editVType">
<option value="ØªÙˆÙƒØªÙˆÙƒ">ØªÙˆÙƒØªÙˆÙƒ</option>
<option value="Ù…ÙˆØªÙˆØ³ÙŠÙƒÙ„">Ù…ÙˆØªÙˆØ³ÙŠÙƒÙ„</option>
<option value="ØªØ±ÙˆØ³ÙŠÙƒÙ„">ØªØ±ÙˆØ³ÙŠÙƒÙ„</option>
<option value="Ù…ÙŠÙƒØ±ÙˆØ¨Ø§Øµ">Ù…ÙŠÙƒØ±ÙˆØ¨Ø§Øµ</option>
</select>
</div>
<div class="input-group">
<label>Ù…ÙˆØ¯ÙŠÙ„ Ø§Ù„Ø³Ù†Ø©</label>
<select id="editVYear"></select>
</div>
<div class="input-group" style="grid-column: 1 / -1;">
<label>Ø§Ù„ÙˆØµÙ ÙˆØ§Ù„Ù„ÙˆÙ†</label>
<input type="text" id="editVDesc">
</div>
<div class="input-group" style="grid-column: 1 / -1;">
<label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
<input type="text" id="editAddress">
</div>
<div class="input-group" style="grid-column: 1 / -1;">
<label>Ø±Ù‚Ù… Ø§Ù„ÙƒÙˆØ¯ (ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø±)</label>
<input type="text" id="editVCode" style="border: 3px solid var(--secondary); font-weight:bold; color:var(--secondary); font-size: 1.3rem; text-align: center;">
</div>
</div>
<div style="display:flex; gap:15px; margin-top:35px;">
<button id="saveEditBtn" class="btn btn-primary" style="flex:1; padding:18px; font-size: 1.1rem;">ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª âœ…</button>
<button onclick="document.getElementById('editModal').style.display='none'" class="btn btn-del" style="flex:1; padding:18px; font-size: 1.1rem;">Ø¥Ù„ØºØ§Ø¡ âŒ</button>
</div>
</div>
</div>
<div id="codeModal" class="modal">
<div class="modal-content" style="max-width:500px; text-align:center;">
<span class="close-modal" onclick="document.getElementById('codeModal').style.display='none'">&times;</span>
<h3 style="color:var(--primary); font-size: 1.8rem;">ğŸ”¢ Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙƒÙˆÙŠØ¯ Ø§Ù„Ø°ÙƒÙŠ</h3>
<p id="codeHint" style="font-size:1.1rem; color:#555; background: rgba(0,0,0,0.06); padding:18px; border-radius:15px; margin: 25px 0; font-weight: 600;"></p>
<div class="input-group">
<label style="justify-content: center;">Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø®ØµØµ Ù„Ù„Ù…Ø±ÙƒØ¨Ø©:</label>
<input type="text" id="manualCodeInput" style="text-align:center; font-size:2.5rem; font-weight:bold; color:var(--secondary); border: 3px solid var(--secondary); height: 80px;">
</div>
<div style="display:flex; gap:15px; margin-top:35px;">
<button id="confirmCodeBtn" class="btn btn-primary" style="flex:1; padding:18px; font-size: 1.1rem;">ØªØ£ÙƒÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯ âœ…</button>
<button onclick="document.getElementById('codeModal').style.display='none'" class="btn btn-del" style="padding:18px; font-size: 1.1rem;">ØªØ¬Ø§Ù‡Ù„ âŒ</button>
</div>
</div>
</div>
<footer class="engineer-footer">
ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ« Ø¨ÙˆØ§Ø³Ø·Ø© Ù…/ Ù…Ù‡Ù†Ø¯ Ø§Ù„ØªÙ‡Ø§Ù…ÙŠ - 01021102607 | Ù†Ø¸Ø§Ù… Ù…ØªØ·ÙˆØ± Ø¨ØªÙ‚Ù†ÙŠØ§Øª Ø­Ø¯ÙŠØ«Ø©
</footer>
<script>
function openService(serviceId) {
document.getElementById('portalSection').style.display = 'none';
document.getElementById(serviceId).style.display = 'block';
document.getElementById('goPortalBtn').style.display = 'inline-flex';
}
function fillYears(selectId) {
const select = document.getElementById(selectId);
if(!select) return;
for (let year = 2000; year <= 2200; year++) {
let opt = document.createElement('option');
opt.value = year; opt.innerText = year;
select.appendChild(opt);
}
}
fillYears('vYear'); fillYears('editVYear');
function validateNationalId(input) {
const nid = input.value.replace(/[^0-9]/g, '');
input.value = nid;
const msgDiv = document.getElementById('nidValidation');
if (nid.length === 0) { msgDiv.style.display = 'none'; input.classList.remove('error'); return; }
if (nid.length !== 14) {
msgDiv.className = 'validation-msg error';
msgDiv.innerText = 'âŒ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 14 Ø±Ù‚Ù…';
input.classList.add('error');
return false;
}
const century = nid[0];
if (!['2', '3'].includes(century)) {
msgDiv.className = 'validation-msg error';
msgDiv.innerText = 'âŒ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­ (ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 2 Ø£Ùˆ 3)';
input.classList.add('error');
return false;
}
const year = parseInt((century === '2' ? '19' : '20') + nid.substring(1, 3));
const month = parseInt(nid.substring(3, 5));
const day = parseInt(nid.substring(5, 7));
if (month < 1 || month > 12 || day < 1 || day > 31) {
msgDiv.className = 'validation-msg error';
msgDiv.innerText = 'âŒ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ ÙÙŠ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­';
input.classList.add('error');
return false;
}
msgDiv.className = 'validation-msg success';
msgDiv.innerText = `âœ… Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ ØµØ­ÙŠØ­ - ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬: ${day}/${month}/${year}`;
input.classList.remove('error');
document.getElementById('birthDate').value = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
return true;
}
function verifyBirthDate() {
const nid = document.getElementById('nationalId').value;
const birthInput = document.getElementById('birthDate').value;
const msgDiv = document.getElementById('birthValidation');
if (!nid || nid.length !== 14 || !birthInput) {
msgDiv.style.display = 'none';
return;
}
const century = nid[0];
const year = parseInt((century === '2' ? '19' : '20') + nid.substring(1, 3));
const month = parseInt(nid.substring(3, 5));
const day = parseInt(nid.substring(5, 7));
const nidDate = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
if (birthInput === nidDate) {
msgDiv.className = 'validation-msg success';
msgDiv.innerText = 'âœ… ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ';
return true;
} else {
msgDiv.className = 'validation-msg error';
msgDiv.innerText = `âŒ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ ØºÙŠØ± Ù…Ø·Ø§Ø¨Ù‚! Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„ØµØ­ÙŠØ­: ${day}/${month}/${year}`;
return false;
}
}
const locations = [
"Ù…Ø¯ÙŠÙ†Ø© ÙƒÙØ± ØµÙ‚Ø±", "Ø­ÙŠ Ø§Ù„Ù†ØµØ±", "Ø­ÙŠ Ø§Ù„Ø²Ù‡ÙˆØ±", "Ø­ÙŠ ØªÙŠØ³ÙŠØ±", "Ø­ÙŠ Ø§Ù„Ø³Ø¹Ø§Ø¯Ø©", "Ø­ÙŠ Ø§Ù„Ø³Ù„Ø§Ù…", "Ø­ÙŠ Ø§Ù„Ø±ÙˆØ¶Ø©",
"Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­Ø·Ø©", "Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­ÙƒÙ…Ø©", "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø¬Ù„Ø§Ø¡", "Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø¹Ø§Ù…", "Ø£Ø¨Ùˆ Ø§Ù„Ø´Ù‚ÙˆÙ‚", "ØªÙ„ÙŠØ¬Ø©",
"Ù…Ù†Ø´Ø£Ø© ÙŠÙˆØ³Ù Ù…Ù†ØµÙˆØ±", "Ø§Ù„Ø­Ù…Ø§Ø¯ÙŠÙŠÙ†", "Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©", "Ø§Ù„Ø¨ÙˆÙ‡Ø§", "Ø§Ù„Ù‡Ø¬Ø§Ø±Ø³Ø©", "Ø§Ø¨Ù† Ø§Ù„Ø¹Ø§Øµ", "Ø§Ù„Ø³Ù„Ø·Ø§Ù† Ø­Ø³Ù†",
"Ø§Ù„Ù‚Ø±Ø§Ù…ÙˆØµ", "ÙƒÙØ± Ø­Ù…Ø§Ø¯", "Ø§Ù„Ù‚Ø¶Ø§Ø©", "Ø§Ù„Ø­ÙˆØ§Ù…Ø¯Ø©", "Ø³Ù†Ø¬Ù‡Ø§", "ÙƒÙØ± Ø§Ù„Ø´Ø§ÙˆÙŠØ´", "Ù†Ø§Ø·ÙˆØ±Ø©", "Ù…Ù†Ø´Ø£Ø© Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ø·ÙŠÙ ÙˆØ§ÙƒØ¯",
"ÙƒÙØ± Ø§Ù„Ø³ÙˆÙŠØ±ÙƒÙŠ", "ÙƒÙØ± Ø§Ù„ÙØ±Ø§ÙŠØ­Ø©", "Ø§Ù„Ù…Ø¤Ø§Ù†Ø³Ø©", "Ø§Ù„Ù…Ø´Ø§Ø¹Ù„Ø©", "Ù…Ù†Ø´Ø£Ø© ØµØ¯Ù‚ÙŠ", "Ø´ÙŠØ· Ø§Ù„Ù‡ÙˆÙ‰", "Ø²ÙˆØ± Ø£Ø¨Ùˆ Ø§Ù„Ù„ÙŠÙ„",
"Ø´Ø§Ù†ÙŠØ· Ø§Ù„Ø£Ø­ÙˆØ§Ø²", "Ù…Ù†Ø´Ø£Ø© Ø¨Ø´Ø§Ø±Ø©", "Ø¢Ù‡ÙŠÙ„", "Ø§Ù„Ø¨ØªÙŠØ©", "ØªÙŠØ±Ø©", "Ø§Ù„Ù…Ø´Ø±Ø¹", "ÙƒÙØ± Ø¨Ø¯Ø±Ø§Ù†", "Ù…Ù†Ø´Ø£Ø© ØµØ¨Ø­ÙŠ",
"Ø´ÙŠÙˆØ§", "ÙƒÙØ± Ø£Ø¨ÙˆØ´ÙŠØ®Ø©", "Ø¹Ø²Ø¨Ø© Ø§Ù„ÙˆÙƒÙŠÙ„", "Ø¹Ø²Ø¨Ø© Ø§Ù„Ø¯Ø¨Ø§Øº", "Ø¹Ø²Ø¨Ø© Ø§Ù„Ø®Ù…Ø³Ø©", "Ø¹Ø²Ø¨Ø© Ø§Ù„ØµÙÙŠØ­", "Ø¹Ø²Ø¨Ø© Ø§Ù„Ø´ÙˆØ§Ù",
"Ø¹Ø²Ø¨Ø© ÙˆØ§ÙƒØ¯", "Ø¹Ø²Ø¨Ø© ØµØ§Ø¯Ù‚", "Ø¹Ø²Ø¨Ø© Ø§Ù„Ø¨Ø­Ø±", "Ø¹Ø²Ø¨Ø© Ø³Ù„Ø§Ù…Ø©", "Ø¹Ø²Ø¨Ø© Ø£Ø¨Ùˆ Ø§Ù„Ù„ÙŠÙ„", "ÙƒÙØ± Ø§Ù„Ø£Ø³ØªØ§Ø°", "Ø¹Ø²Ø¨Ø© Ø¹Ø¨Ø¯ Ø§Ù„Ø³Ù„Ø§Ù…",
"Ø¹Ø²Ø¨Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±", "Ø¹Ø²Ø¨Ø© Ø±Ø£ÙØª", "Ø¹Ø²Ø¨Ø© Ù…Ù†ØµÙˆØ±", "ÙƒÙØ± ÙŠÙˆØ³Ù", "Ø¹Ø²Ø¨Ø© Ø¹Ù„ÙŠ Ø¹Ø¨Ø¯ Ø§Ù„Ø­Ù„ÙŠÙ…", "Ø¹Ø²Ø¨Ø© Ø§Ù„Ù…Ø£Ù…ÙˆØ±",
"Ø¹Ø²Ø¨Ø© Ø§Ù„Ø¨Ø±Ø¬", "Ø¹Ø²Ø¨Ø© Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©", "Ø¹Ø²Ø¨Ø© Ø§Ù„Ø³Ù„Ø·Ø§Ù† Ø®Ø¶Ø±", "Ø¹Ø²Ø¨Ø© Ø¯ÙˆØ´", "Ø¹Ø²Ø¨Ø© Ø¬ÙˆØ¯Ø©", "ÙƒÙØ± Ù‡Ù„Ø§Ù„", "Ø¹Ø²Ø¨Ø© Ù…Ø±Ø§Ø¯",
"Ø¹Ø²Ø¨Ø© Ø£Ø¨Ùˆ ØºØ§Ù†Ù…", "Ø¹Ø²Ø¨Ø© Ø§Ù„Ø´Ø±Ù‚Ø§ÙˆÙŠ", "Ø¹Ø²Ø¨Ø© Ø´Ø§Ù‡ÙŠÙ†", "Ù…Ù†Ø´Ø£Ø© Ø´Ù„Ø¨ÙŠ", "Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠÙŠÙ†", "ÙƒÙØ± Ø£Ø¨Ùˆ Ø´Ø±Ø§Ø¨ÙŠØ©",
"Ø§Ù„ÙØ±Ø§Ø¨ÙŠÙ†", "Ø´Ù†ÙŠØ·Ø© Ø§Ù„Ø­Ø±Ø§Ø¨ÙˆØ©", "Ù†Ø¬ÙˆÙ…", "ÙƒÙØ± ÙŠÙˆÙ†Ø³", "Ø¹Ø²Ø¨Ø© Ø´Ø±Ù", "Ø§Ù„Ù…Ù†Ø´ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©"
];
function filterLocations() {
let input = document.getElementById('locSearchInput').value;
let resultsDiv = document.getElementById('resultsList');
resultsDiv.innerHTML = '';
if (input.length > 0) {
let filtered = locations.filter(loc => loc.includes(input));
if (filtered.length > 0) {
resultsDiv.style.display = 'block';
filtered.forEach(loc => {
let item = document.createElement('div');
item.classList.add('result-item');
item.innerText = loc;
item.onclick = () => selectLocation(loc);
resultsDiv.appendChild(item);
});
} else { resultsDiv.style.display = 'none'; }
} else { resultsDiv.style.display = 'none'; }
}
function selectLocation(loc) {
document.getElementById('locSearchInput').value = loc;
document.getElementById('resultsList').style.display = 'none';
document.getElementById('detailSection').style.display = 'block';
document.getElementById('selectedPlaceLabel').innerText = "Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„ ÙÙŠ (" + loc + "):";
}
</script>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, deleteDoc, doc, updateDoc, getDocs, where } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
const firebaseConfig = {
apiKey: "YOUR_FIREBASE_API_KEY", // Ø¶Ø¹ API Key Ø¨ØªØ§Ø¹Ùƒ Ù‡Ù†Ø§
authDomain: "YOUR_PROJECT.firebaseapp.com",
projectId: "YOUR_PROJECT_ID",
storageBucket: "YOUR_PROJECT.firebasestorage.app",
messagingSenderId: "YOUR_SENDER_ID",
appId: "YOUR_APP_ID"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const dbRef = collection(db, "orders");
const compRef = collection(db, "complaints");
let userRole = "";
let currentEditId = "";

// âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Cloudinary
const CLOUDINARY_CLOUD_NAME = "YOUR_CLOUD_NAME"; // Ø¶Ø¹ Cloud Name Ø¨ØªØ§Ø¹Ùƒ
const CLOUDINARY_UPLOAD_PRESET = "YOUR_UPLOAD_PRESET"; // Ø¶Ø¹ Upload Preset Ø¨ØªØ§Ø¹Ùƒ

const formatDateTime = (ts) => {
if (!ts) return "-";
const d = new Date(ts);
return d.toLocaleDateString('ar-EG') + " " + d.toLocaleTimeString('ar-EG', {hour: '2-digit', minute:'2-digit'});
};

// Ø±ÙØ¹ Ø¹Ù„Ù‰ Cloudinary (25 GB Ù…Ø¬Ø§Ù†ÙŠ)
const uploadToCloudinary = async (file) => {
return new Promise((resolve, reject) => {
const reader = new FileReader();
reader.readAsDataURL(file);
reader.onload = async (e) => {
const img = new Image();
img.src = e.target.result;
img.onload = async () => {
const canvas = document.createElement('canvas');
const maxWidth = 800;
const scale = img.width > maxWidth ? maxWidth / img.width : 1;
canvas.width = img.width * scale;
canvas.height = img.height * scale;
const ctx = canvas.getContext('2d');
ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
canvas.toBlob(async (blob) => {
try {
const formData = new FormData();
formData.append('file', blob);
formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
const response = await fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`, {
method: 'POST',
body: formData
});
const data = await response.json();
if (data.secure_url) {
resolve(data.secure_url);
} else if (data.error) {
console.error('Cloudinary Error:', data.error);
reject(new Error(`Cloudinary: ${data.error.message}`));
} else {
reject(new Error('ÙØ´Ù„ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© - ØªØ­Ù‚Ù‚ Ù…Ù† Upload Preset'));
}
} catch (error) {
console.error('Upload Error:', error);
reject(error);
}
}, 'image/jpeg', 0.70);
};
};
reader.onerror = reject;
});
};
document.getElementById('submitBtn').onclick = async () => {
const btn = document.getElementById('submitBtn');
const files = document.getElementById('multiFiles').files;
const owner = document.getElementById('ownerName').value;
const nid = document.getElementById('nationalId').value;
const phone = document.getElementById('phone').value;
const year = document.getElementById('vYear').value;
const color = document.getElementById('vColor').value;
const mainLocation = document.getElementById('locSearchInput').value;
const extraAddress = document.getElementById('detailedAddress').value;
const birthDate = document.getElementById('birthDate').value;
if (!validateNationalId(document.getElementById('nationalId'))) {
alert("âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‚ÙˆÙ…ÙŠ ØµØ­ÙŠØ­ (14 Ø±Ù‚Ù…)");
return;
}
if (!verifyBirthDate()) {
alert("âŒ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ ØºÙŠØ± Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ");
return;
}
if (nid.length !== 14 || !owner || files.length === 0 || !mainLocation || !year || !birthDate) { 
alert("âŒ ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©"); 
return; 
}
if (phone.length !== 11) {
alert("âŒ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 11 Ø±Ù‚Ù…");
return;
}
document.getElementById('loadingSpinner').style.display = 'block';
const checkSnap = await getDocs(query(dbRef, where("nationalId", "==", nid)));
if(!checkSnap.empty) { 
document.getElementById('loadingSpinner').style.display = 'none';
alert("âŒ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹ ÙÙŠ Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø©!"); 
return; 
}
btn.disabled = true; 
btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± Ø¹Ù„Ù‰ Cloudinary (25 GB Ù…Ø¬Ø§Ù†ÙŠ)...";
try {
const imgUrls = [];
for(let i = 0; i < files.length; i++) { 
const url = await uploadToCloudinary(files[i]);
imgUrls.push(url);
btn.innerText = `Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© ${i + 1} Ù…Ù† ${files.length}...`;
}
await addDoc(dbRef, {
owner, nationalId: nid, phone: phone, birthDate: birthDate,
vType: document.getElementById('vType').value,
vYear: year,
vDesc: `Ù…ÙˆØ¯ÙŠÙ„ ${year} - Ù„ÙˆÙ† ${color}`,
address: mainLocation + " - " + extraAddress, 
images: imgUrls, 
timestamp: Date.now(),
codedAt: null,
vCode: ""
});
document.getElementById('loadingSpinner').style.display = 'none';
alert("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙÙŠ Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø© Ø¨Ù†Ø¬Ø§Ø­!");
location.reload();
} catch (e) { 
document.getElementById('loadingSpinner').style.display = 'none';
alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±: " + e.message); 
btn.disabled = false; 
btn.innerText = "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ âœ…"; 
}
};
document.getElementById('submitCompBtn').onclick = async () => {
const btn = document.getElementById('submitCompBtn');
const phone = document.getElementById('compPhone').value;
const details = document.getElementById('compDetails').value;
const fileInputs = [
document.getElementById('compSelfie'),
document.getElementById('compIdCard'),
document.getElementById('compPlate'),
document.getElementById('compDriverImg')
];
if (phone.length !== 11 || !details || !fileInputs[0].files[0] || !fileInputs[1].files[0]) { 
alert("âŒ ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ 11 Ø±Ù‚Ù…ØŒ Ø§Ù„ØªÙØ§ØµÙŠÙ„ØŒ Ø§Ù„Ø³ÙŠÙ„ÙÙŠØŒ ÙˆØ§Ù„Ø¨Ø·Ø§Ù‚Ø©)"); 
return; 
}
document.getElementById('loadingSpinner').style.display = 'block';
btn.disabled = true; 
btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± Ø§Ù„Ø£Ù…Ù†ÙŠØ© Ø¹Ù„Ù‰ Cloudinary...";
try {
const imgUrls = [];
let imgCount = 0;
for (let input of fileInputs) {
if (input.files.length > 0) {
const url = await uploadToCloudinary(input.files[0]);
imgUrls.push(url);
imgCount++;
btn.innerText = `Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© ${imgCount}...`;
}
}
await addDoc(compRef, {
phone, 
type: document.getElementById('compType').value,
details, 
images: imgUrls, 
timestamp: Date.now()
});
document.getElementById('loadingSpinner').style.display = 'none';
alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù„Ø§ØºÙƒ ÙˆØªÙˆØ«ÙŠÙ‚Ù‡ Ø¨Ù†Ø¬Ø§Ø­");
location.reload();
} catch (error) { 
document.getElementById('loadingSpinner').style.display = 'none';
alert("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: " + error.message); 
btn.disabled = false; 
btn.innerText = "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø´ÙƒÙˆÙ‰ âœ‰ï¸"; 
}
};
document.getElementById('showOrdersBtn').onclick = () => {
document.getElementById('ordersTableContainer').style.display = 'block';
document.getElementById('complaintsTableContainer').style.display = 'none';
};
document.getElementById('showComplaintsBtn').onclick = () => {
document.getElementById('ordersTableContainer').style.display = 'none';
document.getElementById('complaintsTableContainer').style.display = 'block';
loadComplaints();
};
async function getSmartNextCode() {
const snap = await getDocs(dbRef);
let maxCode = 100;
snap.forEach(d => {
const code = parseInt(d.data().vCode);
if(!isNaN(code) && code > maxCode) maxCode = code;
});
return { last: maxCode, next: maxCode + 1 };
}
document.getElementById('loginBtn').onclick = () => {
const u = prompt("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:");
const p = prompt("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:");
if (u === "Eltohamy" && p === "551855125500") {
userRole = "SUPER";
} else {
alert("âŒ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©");
return;
}
document.getElementById('portalSection').style.display = 'none';
document.getElementById('citizenPage').style.display = 'none';
document.getElementById('complaintsModule').style.display = 'none';
document.getElementById('adminPage').style.display = 'block';
document.getElementById('goPortalBtn').style.display = 'inline-flex';
loadAdminData();
loadComplaints();
};
function loadComplaints() {
onSnapshot(query(compRef, orderBy("timestamp", "desc")), (snap) => {
const body = document.getElementById('compTableBody');
body.innerHTML = '';
document.getElementById('statCompTotal').innerText = snap.size;
snap.forEach(s => {
const item = s.data(); 
const id = s.id;
const tr = document.createElement('tr');
tr.innerHTML = `
<td style="font-size:0.9rem;">${formatDateTime(item.timestamp)}</td>
<td style="font-weight:bold; color:var(--primary);">${item.phone}</td>
<td style="color:var(--accent); font-weight:bold; font-size:0.95rem;">${item.type}</td>
<td style="font-size:0.9rem; max-width: 300px;">${item.details}</td>
<td><button class="btn view-comp-images" style="background:rgba(211, 84, 0, 0.15); color:var(--accent); font-weight:bold;">ğŸ–¼ï¸ Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± (${item.images.length})</button></td>
<td><button class="btn btn-del" style="padding:10px 16px;">ğŸ—‘ï¸ Ø­Ø°Ù</button></td>
`;
tr.querySelector('.view-comp-images').onclick = () => viewImages(item.images);
tr.querySelector('.btn-del').onclick = () => {
if(confirm("âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¨Ù„Ø§Øº Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ")) {
deleteDoc(doc(db, "complaints", id));
alert("âœ… ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­");
}
};
body.appendChild(tr);
});
});
}
function viewImages(images) {
const modal = document.getElementById("imgModal");
const mainImg = document.getElementById("mainViewImg");
const thumbContainer = document.getElementById("modalThumbnails");
thumbContainer.innerHTML = ''; 
mainImg.src = images[0];
images.forEach(src => {
const img = document.createElement('img'); 
img.src = src; 
img.style.width="80px"; 
img.style.height="80px"; 
img.style.cursor="pointer"; 
img.style.objectFit="cover"; 
img.style.borderRadius="15px"; 
img.style.border="3px solid white";
img.style.transition="all 0.3s";
img.onmouseover = () => img.style.transform = "scale(1.1)";
img.onmouseout = () => img.style.transform = "scale(1)";
img.onclick = () => mainImg.src = src; 
thumbContainer.appendChild(img);
});
modal.style.display = "block";
}
function loadAdminData() {
onSnapshot(query(dbRef, orderBy("timestamp", "desc")), (snap) => {
const tableBody = document.getElementById('dataTable');
tableBody.innerHTML = '';
let total=0, coded=0, pending=0;
snap.forEach(s => {
const item = s.data(); 
const id = s.id;
total++; 
item.vCode ? coded++ : pending++;
const tr = document.createElement('tr');
tr.innerHTML = `
<td style="font-size:0.85rem; color:#555;">${formatDateTime(item.timestamp)}</td>
<td style="font-weight:bold;">${item.owner}</td>
<td style="font-family:monospace; font-weight:600;">${item.nationalId}</td>
<td style="font-weight:600;">${item.phone || '-'}</td>
<td style="font-size:0.9rem;">${item.address || '-'}</td>
<td><span style="background:linear-gradient(135deg, var(--info) 0%, var(--primary) 100%); color:white; padding:6px 12px; border-radius:10px; font-weight:bold; font-size:0.85rem;">${item.vType}</span></td>
<td style="font-weight:bold; color:var(--primary); font-size:1.05rem;">${item.vYear || '-'}</td>
<td style="font-weight:bold; font-size:1.2rem; color:${item.vCode?'var(--secondary)':'var(--danger)'}">${item.vCode || 'â³ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±'}</td>
<td style="font-size:0.85rem; color:var(--secondary); font-weight:600;">${formatDateTime(item.codedAt)}</td>
<td><button class="btn view-btn" style="background:rgba(26, 82, 118, 0.12); color:var(--primary); padding:10px 16px; font-weight:bold;">ğŸ–¼ï¸ ${item.images.length}</button></td>
<td style="display:flex; gap:8px; flex-wrap:wrap;">
<button class="btn btn-auto" title="ØªÙƒÙˆÙŠØ¯" style="padding:10px 14px;">ğŸ”¢</button>
<button class="btn btn-print" title="Ø·Ø¨Ø§Ø¹Ø©" style="padding:10px 14px;">ğŸ–¨ï¸</button>
<button class="btn btn-edit" title="ØªØ¹Ø¯ÙŠÙ„" style="padding:10px 14px;">âœï¸</button>
<button class="btn btn-del" title="Ø­Ø°Ù" style="padding:10px 14px;">ğŸ—‘ï¸</button>
</td>
`;
tr.querySelector('.btn-auto').onclick = async () => {
if(item.vCode) {
alert("âš ï¸ Ø§Ù„Ù…Ø±ÙƒØ¨Ø© Ù…ÙƒÙˆØ¯Ø© Ø¨Ø§Ù„ÙØ¹Ù„ Ø¨Ø±Ù‚Ù…: " + item.vCode);
return;
}
const info = await getSmartNextCode();
document.getElementById('codeHint').innerText = `Ø¢Ø®Ø± ÙƒÙˆØ¯ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…: (${info.last}) | Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ù‚ØªØ±Ø­: (${info.next})`;
document.getElementById('manualCodeInput').value = info.next;
document.getElementById('codeModal').style.display = 'block';
document.getElementById('confirmCodeBtn').onclick = async () => {
const newCode = document.getElementById('manualCodeInput').value;
if(!newCode) {
alert("âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ ØµØ­ÙŠØ­");
return;
}
document.getElementById('loadingSpinner').style.display = 'block';
await updateDoc(doc(db, "orders", id), { 
vCode: newCode.toString(), 
codedAt: Date.now() 
});
document.getElementById('loadingSpinner').style.display = 'none';
document.getElementById('codeModal').style.display = 'none';
alert("âœ… ØªÙ… Ø§Ù„ØªÙƒÙˆÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­!");
};
};
tr.querySelector('.btn-print').onclick = () => printItem(item);
tr.querySelector('.btn-edit').onclick = () => {
currentEditId = id;
document.getElementById('editOwner').value = item.owner;
document.getElementById('editNid').value = item.nationalId;
document.getElementById('editPhone').value = item.phone;
document.getElementById('editVType').value = item.vType;
document.getElementById('editVYear').value = item.vYear || '';
document.getElementById('editVDesc').value = item.vDesc || '';
document.getElementById('editAddress').value = item.address || '';
document.getElementById('editVCode').value = item.vCode || '';
document.getElementById('editModal').style.display = 'block';
};
tr.querySelector('.btn-del').onclick = () => {
if(confirm("âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ")) {
deleteDoc(doc(db, "orders", id));
alert("âœ… ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­");
}
};
tr.querySelector('.view-btn').onclick = () => viewImages(item.images);
tableBody.appendChild(tr);
});
document.getElementById('statTotal').innerText = total;
document.getElementById('statCoded').innerText = coded;
document.getElementById('statPending').innerText = pending;
});
}
function printItem(item) {
const printContent = `
<div id="printSection" style="direction: rtl; font-family: 'Segoe UI'; padding: 50px; border: 12px double var(--primary); text-align: center; max-width: 800px; margin: auto;">
<h1 style="color: var(--primary); font-size: 2.5rem; margin-bottom: 10px;">ğŸ›ï¸ Ø±Ø¦Ø§Ø³Ø© Ù…Ø±ÙƒØ² ÙˆÙ…Ø¯ÙŠÙ†Ø© ÙƒÙØ± ØµÙ‚Ø±</h1>
<h3 style="color: #666; margin-bottom: 30px;">Ø¯/ Ø£Ø­Ù…Ø¯ Ø§Ù„Ù…Ù‚Ø¯Ù… - Ø±Ø¦ÙŠØ³ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</h3>
<h2 style="border-bottom: 4px solid var(--primary); padding-bottom: 15px; margin-bottom: 30px; color: var(--primary);">Ø¨Ø·Ø§Ù‚Ø© ØªØ¹Ø±ÙŠÙ Ù…Ø±ÙƒØ¨Ø© Ù…Ø¹ØªÙ…Ø¯Ø©</h2>
<div style="text-align: right; font-size: 1.5rem; margin-top: 40px; line-height: 2.5;">
<p><b style="color: var(--primary);">Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ:</b> ${item.owner}</p>
<p><b style="color: var(--primary);">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ:</b> ${item.nationalId}</p>
<p><b style="color: var(--primary);">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</b> ${item.phone || '-'}</p>
<p><b style="color: var(--primary);">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©:</b> ${item.vType}</p>
<p><b style="color: var(--primary);">Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„:</b> ${item.vYear || '-'}</p>
<p><b style="color: var(--primary);">ÙˆØµÙ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©:</b> ${item.vDesc}</p>
<p><b style="color: var(--primary);">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</b> ${item.address}</p>
<p><b style="color: var(--primary);">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙƒÙˆÙŠØ¯:</b> ${formatDateTime(item.codedAt)}</p>
</div>
<div style="margin-top: 60px; padding: 30px; border: 6px solid var(--secondary); display: inline-block; border-radius: 20px; background: linear-gradient(135deg, rgba(39, 174, 96, 0.1) 0%, rgba(46, 204, 113, 0.1) 100%);">
<span style="font-size: 1.4rem; color: #555; display: block; margin-bottom: 15px;">ÙƒÙˆØ¯ Ø§Ù„Ù…Ø±ÙƒØ¨Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯</span>
<b style="font-size: 5rem; color: var(--secondary); font-weight: 900; letter-spacing: 5px;">${item.vCode || 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙƒÙˆÙŠØ¯'}</b>
</div>
<footer style="margin-top: 120px; font-size: 1rem; color: #888; border-top: 2px solid #ddd; padding-top: 20px;">
<p>ØªÙ… Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨ÙˆØ§Ø³Ø·Ø© Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„ØªÙƒÙˆÙŠØ¯ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ù…ØªØ·ÙˆØ±Ø©</p>
<p style="margin-top: 10px;">Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString('ar-EG')}</p>
</footer>
</div>
`;
const originalBody = document.body.innerHTML;
document.body.innerHTML = printContent;
window.print();
location.reload();
}
document.getElementById('saveEditBtn').onclick = async () => {
if(!currentEditId) return;
document.getElementById('loadingSpinner').style.display = 'block';
try {
await updateDoc(doc(db, "orders", currentEditId), {
owner: document.getElementById('editOwner').value,
nationalId: document.getElementById('editNid').value,
phone: document.getElementById('editPhone').value,
vType: document.getElementById('editVType').value,
vYear: document.getElementById('editVYear').value,
vDesc: document.getElementById('editVDesc').value,
address: document.getElementById('editAddress').value,
vCode: document.getElementById('editVCode').value.toString()
});
document.getElementById('loadingSpinner').style.display = 'none';
alert("âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­");
document.getElementById('editModal').style.display = 'none';
} catch (e) { 
document.getElementById('loadingSpinner').style.display = 'none';
alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«"); 
}
};
document.getElementById('closeModalBtn').onclick = () => document.getElementById("imgModal").style.display = "none";
document.getElementById('searchInput').oninput = (e) => {
const term = e.target.value.toLowerCase();
document.querySelectorAll('#dataTable tr, #compTableBody tr').forEach(row => {
row.style.display = row.innerText.toLowerCase().includes(term) ? '' : 'none';
});
};
document.getElementById('exportExcelBtn').onclick = () => {
const wb = XLSX.utils.table_to_book(document.getElementById("excelTable"));
XLSX.writeFile(wb, `Ù…Ù†Ø¸ÙˆÙ…Ø©_ÙƒÙØ±_ØµÙ‚Ø±_${new Date().toLocaleDateString('ar-EG')}.xlsx`);
alert("âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­");
};
window.onclick = (event) => { 
if (event.target.className === 'modal') event.target.style.display = "none"; 
};
</script>
</body>
</html>
